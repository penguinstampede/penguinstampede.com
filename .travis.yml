language: ruby
sudo: false
rvm:
  - 2.2.3

cache:
  directories:
    - vendor

env:
  global:
    - TZ=America/Los Angeles # Makes sure posts are generated with the right timestamp
    - NOKOGIRI_USE_SYSTEM_LIBRARIES=true # speeds up installation of html-proofer
    - JEKYLL_ENV=production

install: bundle install --jobs=3 --retry=3 --path vendor --standalone --deployment

script:
  - bundle exec jekyll doctor
  - npm install
  - npm install grunt grunt-cli -g
  - grunt
  - bundle exec htmlproofer --assume-extension --only-4xx ./_site
